#!/usr/bin/env bash

set -euo pipefail

PROJECT_ROOT="$(cd "$(dirname "$0")" && pwd)"
cd "$PROJECT_ROOT"

args=("$@")
if [[ "${args[0]:-}" == "--nix" ]]; then
  args=("${args[@]:1}")
fi

if command -v mdl >/dev/null 2>&1; then
  exec mdl "${args[@]}"
fi

exec nix run github:7mind/mudyla -- "${args[@]}"
